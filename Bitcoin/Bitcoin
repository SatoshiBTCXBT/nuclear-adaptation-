https://sourceforge.net/p/bitcoin/code/31/#diff-1
